# tunn Configuration
# Copy this file to .env and fill in the values
# All env vars are prefixed with TUNN_

# =============================================================================
# REQUIRED - Core Settings
# =============================================================================

# Environment: dev or prod (defaults to dev)
TUNN_ENV=dev

# Domain for tunnel URLs (e.g., tunn.to for production)
# Dev default: tunn.local.127.0.0.1.nip.io (uses nip.io for local wildcard DNS)
TUNN_DOMAIN=tunn.local.127.0.0.1.nip.io

# JWT secret for signing tokens (REQUIRED in production!)
# Generate with: openssl rand -base64 32
TUNN_JWT_SECRET=CHANGE_ME_TO_RANDOM_SECRET

# =============================================================================
# AUTHENTICATION - Choose One or More
# =============================================================================

# GitHub OAuth (recommended for tunn.to)
# Create app at: https://github.com/settings/applications/new
TUNN_GITHUB_CLIENT_ID=
TUNN_GITHUB_CLIENT_SECRET=

# Client Secret (simple auth for self-hosters)
# All clients share this secret - no OAuth needed
TUNN_CLIENT_SECRET=

# Users file (per-user tokens for self-hosters)
# YAML file with email -> token mappings
TUNN_USERS_FILE=

# =============================================================================
# SERVER - Network Settings
# =============================================================================

# HTTP/2 and HTTP/3 listener addresses
# Default: :8443 for both
TUNN_ADDR=:8443
# TUNN_HTTP2_ADDR=:8443
# TUNN_HTTP3_ADDR=:8443

# TLS certificate paths (required)
TUNN_CERT_FILE=./certs/cert.pem
TUNN_KEY_FILE=./certs/key.pem

# Public address (how clients reach this server)
TUNN_PUBLIC_ADDR=localhost:8443

# =============================================================================
# MULTI-NODE - Cluster Settings
# =============================================================================

# Node secret for inter-node authentication
# All nodes in cluster must share this secret
# Leave empty for single-node deployment
TUNN_NODE_SECRET=

# Other node addresses (comma-separated)
# Leave empty to use Fly.io auto-discovery or single-node mode
TUNN_NODE_ADDRESSES=

# Internal gRPC port for node-to-node communication
TUNN_INTERNAL_GRPC_PORT=:50051

# Custom CA cert for internal TLS (self-hosters with self-signed certs)
TUNN_CA_CERT=

# =============================================================================
# LOGIN NODE - Database Settings
# =============================================================================

# Is this the login node? (owns SQLite database)
# Set to true for single-node or the designated login node in a cluster
TUNN_LOGIN_NODE=true

# SQLite database path (login node only)
TUNN_DB_PATH=

# =============================================================================
# EMAIL - Magic Link Auth (Optional)
# =============================================================================

# SMTP settings for magic link emails
TUNN_SMTP_HOST=
TUNN_SMTP_PORT=587
TUNN_SMTP_USER=
TUNN_SMTP_PASSWORD=
TUNN_SMTP_FROM=

# =============================================================================
# BILLING - Stripe (Optional, tunn.to only)
# =============================================================================

# Stripe secret key (sk_test_... or sk_live_...) for API calls
# Get from: https://dashboard.stripe.com/apikeys
TUNN_STRIPE_SECRET_KEY=

# Stripe webhook secret for handling subscription events
# For local dev: use the whsec_ from `stripe listen`
# For prod: get from https://dashboard.stripe.com/webhooks
TUNN_STRIPE_WEBHOOK_SECRET=

# Stripe Payment Link URLs for Pro tier upgrade
# Create at: https://dashboard.stripe.com/payment-links
TUNN_STRIPE_CHECKOUT_URL_MONTHLY=
TUNN_STRIPE_CHECKOUT_URL_YEARLY=

# =============================================================================
# DEVELOPMENT ONLY
# =============================================================================

# Public mode - DISABLES ALL AUTH (testing only!)
# Never use in production
TUNN_PUBLIC_MODE=false

# Mock OIDC server (dev only, leave empty to disable)
TUNN_MOCK_OIDC_ADDR=:9000
TUNN_MOCK_OIDC_ISSUER=http://localhost:9000

# Well-known key for free tier (not typically changed)
TUNN_WELL_KNOWN_KEY=tunn-free-v1-2025
